
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>8. Reparing values &#8212; Programming for Data Science at URI Spring 2023</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/course-admonitions.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="9. Merging and Databases" href="2023-02-21.html" />
    <link rel="prev" title="7. Tidy Data and Reshaping Datasets" href="2023-02-14.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/310_2021.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Programming for Data Science at URI Spring 2023</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    About this Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Syllabus
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/about.html">
   About
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/tools.html">
   Tools and Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/achievements.html">
   Data Science Achievements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/grading.html">
   Grading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/policies.html">
   Grading Policies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/uri_resources.html">
   Support
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/uri_statements.html">
   General URI Policies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/communication.html">
   Course Communications
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Notes
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="2023-01-24.html">
   1. Welcome and Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2023-01-26.html">
   2. Syllabus and Python Review
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2023-01-31.html">
   3. Grading review, Pandas, and Iterables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2023-02-02.html">
   4. Pandas and Indexing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2023-02-07.html">
   5. Exploratory Data Analysis (EDA)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2023-02-09.html">
   6. Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2023-02-14.html">
   7. Tidy Data and Reshaping Datasets
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   8. Reparing values
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2023-02-21.html">
   9. Merging  and Databases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2023-02-23.html">
   10. Web Scraping
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2023-02-28.html">
   11. Evaluating ML Algorithms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2023-03-02.html">
   12. Auditing with AIF360
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2023-03-07.html">
   13. Intro to ML &amp; Naive Bayes
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/01-syllabus-install.html">
   1. Assignment 1: Portfolio Setup, Data Science, and Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/02-python-access.html">
   2. Assignment 2: Practicing Python and Accessing Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/03-eda.html">
   3. Assignment 3: Exploratory Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/04-prepare.html">
   4. Assignment 4:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/05-construct.html">
   5. Assignment 5: Constructing Datasets and Using Databases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/06-evaluate.html">
   6. Assignment 6: Auditing Algorithms
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Portfolio
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../portfolio/index.html">
   Portfolio
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../portfolio/formatting.html">
   Formatting Tips
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../portfolio/check1ideas.html">
   Portfolio Check 1 Ideas
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  FAQ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../faq/index.html">
   FAQ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../faq/syllabus.html">
   Syllabus and Grading FAQ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../faq/github.html">
   Git and GitHub
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../faq/debugging.html">
   Code Errors
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/python.html">
   References on Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/cheatsheet.html">
   Cheatsheet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/datasets.html">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/tips.html">
   General Tips and Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/learning.html">
   How to Study in this class
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/gettinghelp.html">
   Getting Help with Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/terminal.html">
   Terminals and Environments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/organization.html">
   Getting Organized for class
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://rhodyprog4ds.github.io/BrownFall20/letters/">
   Advice from FA2020 Students
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://rhodyprog4ds.github.io/BrownFall21/letters/">
   Advice from FA2021 Students
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../letters/index.html">
   Letters to Future students
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/rhodyprog4ds/BrownSpring23/main?urlpath=tree/notes/2023-02-16.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/rhodyprog4ds/BrownSpring23/"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/rhodyprog4ds/BrownSpring23//issues/new?title=Issue%20on%20page%20%2Fnotes/2023-02-16.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/rhodyprog4ds/BrownSpring23/edit/main/notes/2023-02-16.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/notes/2023-02-16.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../_sources/notes/2023-02-16.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cleaning-data-review">
   8.1. Cleaning Data review
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-cleaning-data-recipe">
     8.1.1. A Cleaning Data Recipe
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-clean-enough">
   8.2. What is clean enough?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fixing-column-names">
   8.3. Fixing Column names
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#missing-values">
   8.4. Missing Values
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filling-missing-values">
     8.4.1. Filling missing values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dropping-missing-values">
     8.4.2. Dropping missing values
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inconsistent-values">
   8.5. Inconsistent values
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-unpacking-jsons">
   8.6. Example: Unpacking Jsons
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#questions-after-class">
   8.7. Questions After Class
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-the-apply-function-works-use-cases">
     8.7.1. How the apply function works/use cases?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#is-there-a-better-way-to-see-how-many-missing-values">
     8.7.2. Is there a better way to see how many missing values?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#in-col-name-mapper-col-name-col-name-lower-replace-for-col-name-in-coffee-df-columns-what-is-the-for">
     8.7.3. in
     <code class="docutils literal notranslate">
      <span class="pre">
       col_name_mapper
      </span>
      <span class="pre">
       =
      </span>
      <span class="pre">
       {col_name:col_name.lower().replace('.','_')
      </span>
      <span class="pre">
       for
      </span>
      <span class="pre">
       col_name
      </span>
      <span class="pre">
       in
      </span>
      <span class="pre">
       coffee_df.columns}
      </span>
     </code>
     what is the
     <code class="docutils literal notranslate">
      <span class="pre">
       {}
      </span>
     </code>
     for?
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Reparing values</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cleaning-data-review">
   8.1. Cleaning Data review
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-cleaning-data-recipe">
     8.1.1. A Cleaning Data Recipe
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-clean-enough">
   8.2. What is clean enough?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fixing-column-names">
   8.3. Fixing Column names
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#missing-values">
   8.4. Missing Values
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filling-missing-values">
     8.4.1. Filling missing values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dropping-missing-values">
     8.4.2. Dropping missing values
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inconsistent-values">
   8.5. Inconsistent values
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-unpacking-jsons">
   8.6. Example: Unpacking Jsons
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#questions-after-class">
   8.7. Questions After Class
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-the-apply-function-works-use-cases">
     8.7.1. How the apply function works/use cases?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#is-there-a-better-way-to-see-how-many-missing-values">
     8.7.2. Is there a better way to see how many missing values?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#in-col-name-mapper-col-name-col-name-lower-replace-for-col-name-in-coffee-df-columns-what-is-the-for">
     8.7.3. in
     <code class="docutils literal notranslate">
      <span class="pre">
       col_name_mapper
      </span>
      <span class="pre">
       =
      </span>
      <span class="pre">
       {col_name:col_name.lower().replace('.','_')
      </span>
      <span class="pre">
       for
      </span>
      <span class="pre">
       col_name
      </span>
      <span class="pre">
       in
      </span>
      <span class="pre">
       coffee_df.columns}
      </span>
     </code>
     what is the
     <code class="docutils literal notranslate">
      <span class="pre">
       {}
      </span>
     </code>
     for?
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="reparing-values">
<h1><span class="section-number">8. </span>Reparing values<a class="headerlink" href="#reparing-values" title="Permalink to this headline">#</a></h1>
<p>So far, we’ve dealt with structural issues in data. but there’s a lot more to
cleaning.</p>
<p>Today,  we’ll deal with how to fix the values within  the data.</p>
<div class="section" id="cleaning-data-review">
<h2><span class="section-number">8.1. </span>Cleaning Data review<a class="headerlink" href="#cleaning-data-review" title="Permalink to this headline">#</a></h2>
<p>Instead of more practice with these manipulations, below are more
examples of cleaning data to see how these types of manipulations get used.<br />
Your goal here is not to memorize every possible thing, but to build a general
idea of what good data looks like and good habits for cleaning data and keeping
it reproducible.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://ryanwingate.com/projects/machine-learning-data-prep/adult/adult-cleaning/">Cleaning the Adult Dataset</a></p></li>
<li><p><a class="reference external" href="https://github.com/the-pudding/data/tree/master/foundation-names#allshadescsv--allshadesr">All Shades</a>
Also here are some tips on general data management and organization.</p></li>
</ul>
<p>This article is a comprehensive <a class="reference external" href="https://towardsdatascience.com/the-ultimate-guide-to-data-cleaning-3969843991d4">discussion of data cleaning</a>.</p>
<div class="section" id="a-cleaning-data-recipe">
<h3><span class="section-number">8.1.1. </span>A Cleaning Data Recipe<a class="headerlink" href="#a-cleaning-data-recipe" title="Permalink to this headline">#</a></h3>
<p><strong>not everything possible, but good enough for this course</strong></p>
<ol class="simple">
<li><p>Can you use parameters to read the data in better?</p></li>
<li><p>Fix the index and column headers (making these easier to use makes the rest easier)</p></li>
<li><p>Is the data strucutred well?</p></li>
<li><p>Are there missing values?</p></li>
<li><p>Do the datatypes match what you expect by looking at the head or a sample?</p></li>
<li><p>Are categorical variables represented in usable way?</p></li>
<li><p>Does your analysis require filtering or augmenting the data?</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1">#</span>
<span class="n">na_toy_df_np</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">2</span> <span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]])</span>
<span class="n">na_toy_df_pd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">2</span> <span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">NA</span><span class="p">]])</span>

<span class="c1"># make plots look nicer and increase font size</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">arabica_data_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/jldbc/coffee-quality-database/master/data/arabica_data_cleaned.csv&#39;</span>

<span class="n">coffee_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">arabica_data_url</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="n">rhodyprog4ds_gh_events_url</span> <span class="o">=</span> <span class="s1">&#39;https://api.github.com/orgs/rhodyprog4ds/events&#39;</span>
<span class="n">course_gh_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">rhodyprog4ds_gh_events_url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="what-is-clean-enough">
<h2><span class="section-number">8.2. </span>What is clean enough?<a class="headerlink" href="#what-is-clean-enough" title="Permalink to this headline">#</a></h2>
<p>This is a great question, without an easy answer.</p>
<p>It depends on what you want to do.  This is why it’s important to have potential
questions in mind if you are cleaning data for others <em>and</em> why we often have to
do a little bit more preparation after a dataset has been “cleaned”</p>
</div>
<div class="section" id="fixing-column-names">
<h2><span class="section-number">8.3. </span>Fixing Column names<a class="headerlink" href="#fixing-column-names" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Species&#39;, &#39;Owner&#39;, &#39;Country.of.Origin&#39;, &#39;Farm.Name&#39;, &#39;Lot.Number&#39;,
       &#39;Mill&#39;, &#39;ICO.Number&#39;, &#39;Company&#39;, &#39;Altitude&#39;, &#39;Region&#39;, &#39;Producer&#39;,
       &#39;Number.of.Bags&#39;, &#39;Bag.Weight&#39;, &#39;In.Country.Partner&#39;, &#39;Harvest.Year&#39;,
       &#39;Grading.Date&#39;, &#39;Owner.1&#39;, &#39;Variety&#39;, &#39;Processing.Method&#39;, &#39;Aroma&#39;,
       &#39;Flavor&#39;, &#39;Aftertaste&#39;, &#39;Acidity&#39;, &#39;Body&#39;, &#39;Balance&#39;, &#39;Uniformity&#39;,
       &#39;Clean.Cup&#39;, &#39;Sweetness&#39;, &#39;Cupper.Points&#39;, &#39;Total.Cup.Points&#39;,
       &#39;Moisture&#39;, &#39;Category.One.Defects&#39;, &#39;Quakers&#39;, &#39;Color&#39;,
       &#39;Category.Two.Defects&#39;, &#39;Expiration&#39;, &#39;Certification.Body&#39;,
       &#39;Certification.Address&#39;, &#39;Certification.Contact&#39;, &#39;unit_of_measurement&#39;,
       &#39;altitude_low_meters&#39;, &#39;altitude_high_meters&#39;, &#39;altitude_mean_meters&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_name_mapper</span> <span class="o">=</span> <span class="p">{</span><span class="n">col_name</span><span class="p">:</span><span class="n">col_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="n">coffee_df</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">col_name_mapper</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>owner</th>
      <th>country_of_origin</th>
      <th>farm_name</th>
      <th>lot_number</th>
      <th>mill</th>
      <th>ico_number</th>
      <th>company</th>
      <th>altitude</th>
      <th>region</th>
      <th>...</th>
      <th>color</th>
      <th>category_two_defects</th>
      <th>expiration</th>
      <th>certification_body</th>
      <th>certification_address</th>
      <th>certification_contact</th>
      <th>unit_of_measurement</th>
      <th>altitude_low_meters</th>
      <th>altitude_high_meters</th>
      <th>altitude_mean_meters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Arabica</td>
      <td>metad plc</td>
      <td>Ethiopia</td>
      <td>metad plc</td>
      <td>NaN</td>
      <td>metad plc</td>
      <td>2014/2015</td>
      <td>metad agricultural developmet plc</td>
      <td>1950-2200</td>
      <td>guji-hambela</td>
      <td>...</td>
      <td>Green</td>
      <td>0</td>
      <td>April 3rd, 2016</td>
      <td>METAD Agricultural Development plc</td>
      <td>309fcf77415a3661ae83e027f7e5f05dad786e44</td>
      <td>19fef5a731de2db57d16da10287413f5f99bc2dd</td>
      <td>m</td>
      <td>1950.0</td>
      <td>2200.0</td>
      <td>2075.0</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 43 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>Owner</th>
      <th>Country.of.Origin</th>
      <th>Farm.Name</th>
      <th>Lot.Number</th>
      <th>Mill</th>
      <th>ICO.Number</th>
      <th>Company</th>
      <th>Altitude</th>
      <th>Region</th>
      <th>...</th>
      <th>Color</th>
      <th>Category.Two.Defects</th>
      <th>Expiration</th>
      <th>Certification.Body</th>
      <th>Certification.Address</th>
      <th>Certification.Contact</th>
      <th>unit_of_measurement</th>
      <th>altitude_low_meters</th>
      <th>altitude_high_meters</th>
      <th>altitude_mean_meters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Arabica</td>
      <td>metad plc</td>
      <td>Ethiopia</td>
      <td>metad plc</td>
      <td>NaN</td>
      <td>metad plc</td>
      <td>2014/2015</td>
      <td>metad agricultural developmet plc</td>
      <td>1950-2200</td>
      <td>guji-hambela</td>
      <td>...</td>
      <td>Green</td>
      <td>0</td>
      <td>April 3rd, 2016</td>
      <td>METAD Agricultural Development plc</td>
      <td>309fcf77415a3661ae83e027f7e5f05dad786e44</td>
      <td>19fef5a731de2db57d16da10287413f5f99bc2dd</td>
      <td>m</td>
      <td>1950.0</td>
      <td>2200.0</td>
      <td>2075.0</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 43 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df_fixedcols</span> <span class="o">=</span> <span class="n">coffee_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">col_name_mapper</span><span class="p">)</span>
<span class="n">coffee_df_fixedcols</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>owner</th>
      <th>country_of_origin</th>
      <th>farm_name</th>
      <th>lot_number</th>
      <th>mill</th>
      <th>ico_number</th>
      <th>company</th>
      <th>altitude</th>
      <th>region</th>
      <th>...</th>
      <th>color</th>
      <th>category_two_defects</th>
      <th>expiration</th>
      <th>certification_body</th>
      <th>certification_address</th>
      <th>certification_contact</th>
      <th>unit_of_measurement</th>
      <th>altitude_low_meters</th>
      <th>altitude_high_meters</th>
      <th>altitude_mean_meters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Arabica</td>
      <td>metad plc</td>
      <td>Ethiopia</td>
      <td>metad plc</td>
      <td>NaN</td>
      <td>metad plc</td>
      <td>2014/2015</td>
      <td>metad agricultural developmet plc</td>
      <td>1950-2200</td>
      <td>guji-hambela</td>
      <td>...</td>
      <td>Green</td>
      <td>0</td>
      <td>April 3rd, 2016</td>
      <td>METAD Agricultural Development plc</td>
      <td>309fcf77415a3661ae83e027f7e5f05dad786e44</td>
      <td>19fef5a731de2db57d16da10287413f5f99bc2dd</td>
      <td>m</td>
      <td>1950.0</td>
      <td>2200.0</td>
      <td>2075.0</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 43 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df_fixedcols</span><span class="p">[</span><span class="s1">&#39;unit_of_measurement&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>m     1129
ft     182
Name: unit_of_measurement, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df_fixedcols</span><span class="p">[</span><span class="s1">&#39;unit_of_measurement&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;m&#39;</span><span class="p">:</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span><span class="s1">&#39;ft&#39;</span><span class="p">:</span><span class="s1">&#39;feet&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1       meters
2       meters
3       meters
4       meters
5       meters
         ...  
1307    meters
1308    meters
1309    meters
1310      feet
1312    meters
Name: unit_of_measurement, Length: 1311, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df_fixedcols</span><span class="p">[</span><span class="s1">&#39;unit_of_measurement_long&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">coffee_df_fixedcols</span><span class="p">[</span><span class="s1">&#39;unit_of_measurement&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                                    <span class="p">{</span><span class="s1">&#39;m&#39;</span><span class="p">:</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span><span class="s1">&#39;ft&#39;</span><span class="p">:</span><span class="s1">&#39;feet&#39;</span><span class="p">})</span>
<span class="n">coffee_df_fixedcols</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>owner</th>
      <th>country_of_origin</th>
      <th>farm_name</th>
      <th>lot_number</th>
      <th>mill</th>
      <th>ico_number</th>
      <th>company</th>
      <th>altitude</th>
      <th>region</th>
      <th>...</th>
      <th>category_two_defects</th>
      <th>expiration</th>
      <th>certification_body</th>
      <th>certification_address</th>
      <th>certification_contact</th>
      <th>unit_of_measurement</th>
      <th>altitude_low_meters</th>
      <th>altitude_high_meters</th>
      <th>altitude_mean_meters</th>
      <th>unit_of_measurement_long</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Arabica</td>
      <td>metad plc</td>
      <td>Ethiopia</td>
      <td>metad plc</td>
      <td>NaN</td>
      <td>metad plc</td>
      <td>2014/2015</td>
      <td>metad agricultural developmet plc</td>
      <td>1950-2200</td>
      <td>guji-hambela</td>
      <td>...</td>
      <td>0</td>
      <td>April 3rd, 2016</td>
      <td>METAD Agricultural Development plc</td>
      <td>309fcf77415a3661ae83e027f7e5f05dad786e44</td>
      <td>19fef5a731de2db57d16da10287413f5f99bc2dd</td>
      <td>m</td>
      <td>1950.0</td>
      <td>2200.0</td>
      <td>2075.0</td>
      <td>meters</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 44 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="missing-values">
<h2><span class="section-number">8.4. </span>Missing Values<a class="headerlink" href="#missing-values" title="Permalink to this headline">#</a></h2>
<p>Dealing with missing data is a whole research area. There isn’t one solution.</p>
<p><a class="reference external" href="https://artemiss-workshop.github.io/">in 2020 there was a whole workshop on missing</a></p>
<p>one organizer is the main developer of <a class="reference external" href="https://scikit-learn.org/stable/">sci-kit learn</a> the ML package we will use soon.  In a <a class="reference external" href="https://static.sched.com/hosted_files/ray2020/08/Keynote-%20Easier%20Machine%20Learning%20Thoughts%20From%20Scikit-Learn%20-%20Ga%C3%ABl%20Varoquaux%2C%20Research%20Director%2C%20Inria.pdf">2020 invited talk</a> he listed more automatic handling as an active area of research  and a development goal for sklearn.</p>
<p>There are also many classic approaches both when training and when <a class="reference external" href="https://www.jmlr.org/papers/volume8/saar-tsechansky07a/saar-tsechansky07a.pdf">applying models</a>.</p>
<p><a class="reference external" href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.701.4234&amp;rep=rep1&amp;type=pdf">example application in breast cancer detection</a></p>
<p>Even in pandas, dealing with <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/missing_data.html">missing values</a> is under <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/missing_data.html#missing-data-na">experimentation</a>
as to how to represent it symbolically</p>
<p>Missing values even causes the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/missing_data.html#missing-data-casting-rules-and-indexing">datatypes to change</a></p>
<p>That said, there are are om
Pandas gives a few basic tools:</p>
<ul class="simple">
<li><p>dropna</p></li>
<li><p>fillna</p></li>
</ul>
<p>Dropping is a good choice when you otherwise have a lot of data and the data is
missing at random.</p>
<p>Dropping can be risky if it’s not missing at random. For example, if we saw in
the coffee data that one of the scores was missing for all of the rows from one
country, or even just missing more often in one country, that could bias our
results.</p>
<p>Filling can be good if you know how to fill reasonably, but don’t have data to
spare by dropping.  For example</p>
<ul class="simple">
<li><p>you can approximate with another column</p></li>
<li><p>you can approximate with that column from other rows</p></li>
</ul>
<p>Special case, what if we’re filling a summary table?</p>
<ul class="simple">
<li><p>filling with a symbol for printing can be a good choice, but not for analysis.</p></li>
</ul>
<p><strong>whatever you do, document it</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df_fixedcols</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 1311 entries, 1 to 1312
Data columns (total 44 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  
 0   species                   1311 non-null   object 
 1   owner                     1304 non-null   object 
 2   country_of_origin         1310 non-null   object 
 3   farm_name                 955 non-null    object 
 4   lot_number                270 non-null    object 
 5   mill                      1001 non-null   object 
 6   ico_number                1165 non-null   object 
 7   company                   1102 non-null   object 
 8   altitude                  1088 non-null   object 
 9   region                    1254 non-null   object 
 10  producer                  1081 non-null   object 
 11  number_of_bags            1311 non-null   int64  
 12  bag_weight                1311 non-null   object 
 13  in_country_partner        1311 non-null   object 
 14  harvest_year              1264 non-null   object 
 15  grading_date              1311 non-null   object 
 16  owner_1                   1304 non-null   object 
 17  variety                   1110 non-null   object 
 18  processing_method         1159 non-null   object 
 19  aroma                     1311 non-null   float64
 20  flavor                    1311 non-null   float64
 21  aftertaste                1311 non-null   float64
 22  acidity                   1311 non-null   float64
 23  body                      1311 non-null   float64
 24  balance                   1311 non-null   float64
 25  uniformity                1311 non-null   float64
 26  clean_cup                 1311 non-null   float64
 27  sweetness                 1311 non-null   float64
 28  cupper_points             1311 non-null   float64
 29  total_cup_points          1311 non-null   float64
 30  moisture                  1311 non-null   float64
 31  category_one_defects      1311 non-null   int64  
 32  quakers                   1310 non-null   float64
 33  color                     1095 non-null   object 
 34  category_two_defects      1311 non-null   int64  
 35  expiration                1311 non-null   object 
 36  certification_body        1311 non-null   object 
 37  certification_address     1311 non-null   object 
 38  certification_contact     1311 non-null   object 
 39  unit_of_measurement       1311 non-null   object 
 40  altitude_low_meters       1084 non-null   float64
 41  altitude_high_meters      1084 non-null   float64
 42  altitude_mean_meters      1084 non-null   float64
 43  unit_of_measurement_long  1311 non-null   object 
dtypes: float64(16), int64(3), object(25)
memory usage: 460.9+ KB
</pre></div>
</div>
</div>
</div>
<div class="section" id="filling-missing-values">
<h3><span class="section-number">8.4.1. </span>Filling missing values<a class="headerlink" href="#filling-missing-values" title="Permalink to this headline">#</a></h3>
<p>The ‘Lot.Number’ has a lot of NaN values, how can we explore it?</p>
<p>We can look at the type:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df_fixedcols</span><span class="p">[</span><span class="s1">&#39;lot_number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype(&#39;O&#39;)
</pre></div>
</div>
</div>
</div>
<p>And we can look at the value counts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df_fixedcols</span><span class="p">[</span><span class="s1">&#39;lot_number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1                             18
020/17                         6
019/17                         5
2                              3
102                            3
                              ..
11/23/0696                     1
3-59-2318                      1
8885                           1
5055                           1
017-053-0211/ 017-053-0212     1
Name: lot_number, Length: 221, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We see that a lot are ‘1’, maybe we know that when the data was collected, if the Farm only has one lot, some people recorded ‘1’ and others left it as missing. So we could fill in with 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df_fixedcols</span><span class="p">[</span><span class="s1">&#39;lot_number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1                                1
2                                1
3                                1
4                                1
5                                1
                   ...            
1307                             1
1308                             1
1309    017-053-0211/ 017-053-0212
1310                             1
1312                           103
Name: lot_number, Length: 1311, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Note that even after we called <code class="docutils literal notranslate"><span class="pre">fillna</span></code> we display it again and the original data is unchanged.
To save the filled in column we have a few choices:</p>
<ul class="simple">
<li><p>use the <code class="docutils literal notranslate"><span class="pre">inplace</span></code> parameter. This doesn’t offer performance advantages, but does It still copies the object, but then reassigns the pointer. Its under discussion to <a class="reference external" href="https://github.com/pandas-dev/pandas/issues/16529">deprecate</a></p></li>
<li><p>write to a new DataFrame</p></li>
<li><p>add a column</p></li>
</ul>
<p>We’ll use adding a column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df_fixedcols</span><span class="p">[</span><span class="s1">&#39;lot_number_clean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">coffee_df_fixedcols</span><span class="p">[</span><span class="s1">&#39;lot_number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df_fixedcols</span><span class="p">[</span><span class="s1">&#39;lot_number_clean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1                             1059
020/17                           6
019/17                           5
102                              3
103                              3
                              ... 
3-59-2318                        1
8885                             1
5055                             1
MCCFWXA15/16                     1
017-053-0211/ 017-053-0212       1
Name: lot_number_clean, Length: 221, dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dropping-missing-values">
<h3><span class="section-number">8.4.2. </span>Dropping missing values<a class="headerlink" href="#dropping-missing-values" title="Permalink to this headline">#</a></h3>
<p>To illustrate how <code class="docutils literal notranslate"><span class="pre">dropna</span></code> works, we’ll use the <code class="docutils literal notranslate"><span class="pre">shape</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df_fixedcols</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1311, 45)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df_fixedcols</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(130, 45)
</pre></div>
</div>
</div>
</div>
<p>By default, it drops any row with one or more <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values.</p>
<p>We could instead tell it to only drop rows with <code class="docutils literal notranslate"><span class="pre">NaN</span></code> in a subset of the columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df_fixedcols</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;altitude_low_meters&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1084, 45)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_alt_df</span> <span class="o">=</span> <span class="n">coffee_df_fixedcols</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;altitude_low_meters&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>In the <a class="reference external" href="https://openpolicing.stanford.edu/data/">Open Policing Project Data Summary</a> we saw that they made a summary information that showed which variables had at least 70% not missing values.  We can similarly choose to keep only variables that have more than a specific threshold of data, using the <code class="docutils literal notranslate"><span class="pre">thresh</span></code> parameter and <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> to drop along columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">coffee_df_fixedcols</span><span class="o">.</span><span class="n">shape</span>
<span class="n">coffee_df_fixedcols</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">7</span><span class="o">*</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1311, 44)
</pre></div>
</div>
</div>
</div>
<p>This dataset is actually in pretty good shape, but if we use a more stringent threshold it drops more columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df_fixedcols</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">85</span><span class="o">*</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1311, 34)
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="inconsistent-values">
<h2><span class="section-number">8.5. </span>Inconsistent values<a class="headerlink" href="#inconsistent-values" title="Permalink to this headline">#</a></h2>
<p>This was one of the things that many of you anticipated or had observed.  A useful way to investigate for this, is to use <code class="docutils literal notranslate"><span class="pre">value_counts</span></code> and sort them alphabetically by the values from the original data, so that similar ones will be consecutive in the list. Once we have the <code class="docutils literal notranslate"><span class="pre">value_counts()</span></code> Series, the values from the <code class="docutils literal notranslate"><span class="pre">coffee_df</span></code> become the index, so we use <code class="docutils literal notranslate"><span class="pre">sort_index</span></code>.</p>
<p>Let’s look at the <code class="docutils literal notranslate"><span class="pre">in_country_partner</span></code> column</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df_fixedcols</span><span class="p">[</span><span class="s1">&#39;in_country_partner&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AMECAFE                                                                                  205
Africa Fine Coffee Association                                                            49
Almacafé                                                                                 178
Asociacion Nacional Del Café                                                             155
Asociación Mexicana De Cafés y Cafeterías De Especialidad A.C.                             6
Asociación de Cafés Especiales de Nicaragua                                                8
Blossom Valley International                                                              58
Blossom Valley International\n                                                             1
Brazil Specialty Coffee Association                                                       67
Central De Organizaciones Productoras De Café y Cacao Del Perú - Central Café &amp; Cacao      1
Centro Agroecológico del Café A.C.                                                         8
Coffee Quality Institute                                                                   7
Ethiopia Commodity Exchange                                                               18
Instituto Hondureño del Café                                                              60
Kenya Coffee Traders Association                                                          22
METAD Agricultural Development plc                                                        15
NUCOFFEE                                                                                  36
Salvadoran Coffee Council                                                                 11
Specialty Coffee Ass                                                                       1
Specialty Coffee Association                                                             295
Specialty Coffee Association of Costa Rica                                                42
Specialty Coffee Association of Indonesia                                                 10
Specialty Coffee Institute of Asia                                                        16
Tanzanian Coffee Board                                                                     6
Torch Coffee Lab Yunnan                                                                    2
Uganda Coffee Development Authority                                                       22
Yunnan Coffee Exchange                                                                    12
Name: in_country_partner, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We can see there’s only one <code class="docutils literal notranslate"><span class="pre">Blossom</span> <span class="pre">Valley</span> <span class="pre">International\n</span></code> but 58 <code class="docutils literal notranslate"><span class="pre">Blossom</span> <span class="pre">Valley</span> <span class="pre">International</span></code>, the former is likely a typo, especially since <code class="docutils literal notranslate"><span class="pre">\n</span></code> is a special character for a newline. Similarly, with ‘Specialty Coffee Ass’ and ‘Specialty Coffee Association’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">partner_corrections</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Blossom Valley International</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span><span class="s1">&#39;Blossom Valley International&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Specialty Coffee Ass&#39;</span><span class="p">:</span><span class="s1">&#39;Specialty Coffee Association&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df_clean</span> <span class="o">=</span> <span class="n">coffee_df_fixedcols</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">partner_corrections</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="example-unpacking-jsons">
<h2><span class="section-number">8.6. </span>Example: Unpacking Jsons<a class="headerlink" href="#example-unpacking-jsons" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rhodyprog4ds_gh_events_url</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;https://api.github.com/orgs/rhodyprog4ds/events&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gh_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">rhodyprog4ds_gh_events_url</span><span class="p">)</span>
<span class="n">gh_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>type</th>
      <th>actor</th>
      <th>repo</th>
      <th>payload</th>
      <th>public</th>
      <th>created_at</th>
      <th>org</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>27566343224</td>
      <td>PushEvent</td>
      <td>{'id': 41898282, 'login': 'github-actions[bot]...</td>
      <td>{'id': 592944632, 'name': 'rhodyprog4ds/BrownS...</td>
      <td>{'repository_id': 592944632, 'push_id': 128636...</td>
      <td>True</td>
      <td>2023-03-08 04:20:33+00:00</td>
      <td>{'id': 69595187, 'login': 'rhodyprog4ds', 'gra...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>27566322788</td>
      <td>PushEvent</td>
      <td>{'id': 41898282, 'login': 'github-actions[bot]...</td>
      <td>{'id': 592944632, 'name': 'rhodyprog4ds/BrownS...</td>
      <td>{'repository_id': 592944632, 'push_id': 128636...</td>
      <td>True</td>
      <td>2023-03-08 04:18:47+00:00</td>
      <td>{'id': 69595187, 'login': 'rhodyprog4ds', 'gra...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>27566302748</td>
      <td>PushEvent</td>
      <td>{'id': 10656079, 'login': 'brownsarahm', 'disp...</td>
      <td>{'id': 592944632, 'name': 'rhodyprog4ds/BrownS...</td>
      <td>{'repository_id': 592944632, 'push_id': 128636...</td>
      <td>True</td>
      <td>2023-03-08 04:17:02+00:00</td>
      <td>{'id': 69595187, 'login': 'rhodyprog4ds', 'gra...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>27566292375</td>
      <td>PushEvent</td>
      <td>{'id': 41898282, 'login': 'github-actions[bot]...</td>
      <td>{'id': 592944632, 'name': 'rhodyprog4ds/BrownS...</td>
      <td>{'repository_id': 592944632, 'push_id': 128635...</td>
      <td>True</td>
      <td>2023-03-08 04:16:08+00:00</td>
      <td>{'id': 69595187, 'login': 'rhodyprog4ds', 'gra...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>27566280466</td>
      <td>PushEvent</td>
      <td>{'id': 10656079, 'login': 'brownsarahm', 'disp...</td>
      <td>{'id': 592944632, 'name': 'rhodyprog4ds/BrownS...</td>
      <td>{'repository_id': 592944632, 'push_id': 128635...</td>
      <td>True</td>
      <td>2023-03-08 04:15:05+00:00</td>
      <td>{'id': 69595187, 'login': 'rhodyprog4ds', 'gra...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Some datasets have a nested structure</p>
<p>We want to transform each one of those from a dictionary like thing into a
row in a data frame.</p>
<p>We can see each row is a Series type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">gh_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.series.Series
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span> <span class="s1">&#39;1&#39;</span>
<span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>str
</pre></div>
</div>
</div>
</div>
<p>Recall, that base python types can be used as function, to cast an object from
type to another.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>int
</pre></div>
</div>
</div>
</div>
<p>This works with Pandas Series too</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">gh_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;actor&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id                                                        41898282
login                                          github-actions[bot]
display_login                                       github-actions
gravatar_id                                                       
url               https://api.github.com/users/github-actions[bot]
avatar_url       https://avatars.githubusercontent.com/u/41898282?
dtype: object
</pre></div>
</div>
</div>
</div>
<p>We can use <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.apply.html">pandas <code class="docutils literal notranslate"><span class="pre">apply</span></code></a> to do the same thing to every item in a dataset (over rows or columns as items )
For example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gh_df</span><span class="p">[</span><span class="s1">&#39;actor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>login</th>
      <th>display_login</th>
      <th>gravatar_id</th>
      <th>url</th>
      <th>avatar_url</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>41898282</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
    </tr>
    <tr>
      <th>1</th>
      <td>41898282</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
    <tr>
      <th>3</th>
      <td>41898282</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>compared to the original:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gh_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>type</th>
      <th>actor</th>
      <th>repo</th>
      <th>payload</th>
      <th>public</th>
      <th>created_at</th>
      <th>org</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>27566343224</td>
      <td>PushEvent</td>
      <td>{'id': 41898282, 'login': 'github-actions[bot]...</td>
      <td>{'id': 592944632, 'name': 'rhodyprog4ds/BrownS...</td>
      <td>{'repository_id': 592944632, 'push_id': 128636...</td>
      <td>True</td>
      <td>2023-03-08 04:20:33+00:00</td>
      <td>{'id': 69595187, 'login': 'rhodyprog4ds', 'gra...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We want to handle several columns this way, so we’ll make alist of the names.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">js_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;actor&#39;</span><span class="p">,</span><span class="s1">&#39;repo&#39;</span><span class="p">,</span><span class="s1">&#39;payload&#39;</span><span class="p">,</span><span class="s1">&#39;org&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pd.concat</span></code> takes a list of dataframes and puts the together in one DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">gh_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">js_cols</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>login</th>
      <th>display_login</th>
      <th>gravatar_id</th>
      <th>url</th>
      <th>avatar_url</th>
      <th>id</th>
      <th>name</th>
      <th>url</th>
      <th>repository_id</th>
      <th>...</th>
      <th>ref_type</th>
      <th>master_branch</th>
      <th>description</th>
      <th>pusher_type</th>
      <th>issue</th>
      <th>id</th>
      <th>login</th>
      <th>gravatar_id</th>
      <th>url</th>
      <th>avatar_url</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>41898282</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
      <td>592944632</td>
      <td>rhodyprog4ds/BrownSpring23</td>
      <td>https://api.github.com/repos/rhodyprog4ds/Brow...</td>
      <td>592944632.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>69595187</td>
      <td>rhodyprog4ds</td>
      <td></td>
      <td>https://api.github.com/orgs/rhodyprog4ds</td>
      <td>https://avatars.githubusercontent.com/u/69595187?</td>
    </tr>
    <tr>
      <th>1</th>
      <td>41898282</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
      <td>592944632</td>
      <td>rhodyprog4ds/BrownSpring23</td>
      <td>https://api.github.com/repos/rhodyprog4ds/Brow...</td>
      <td>592944632.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>69595187</td>
      <td>rhodyprog4ds</td>
      <td></td>
      <td>https://api.github.com/orgs/rhodyprog4ds</td>
      <td>https://avatars.githubusercontent.com/u/69595187?</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
      <td>592944632</td>
      <td>rhodyprog4ds/BrownSpring23</td>
      <td>https://api.github.com/repos/rhodyprog4ds/Brow...</td>
      <td>592944632.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>69595187</td>
      <td>rhodyprog4ds</td>
      <td></td>
      <td>https://api.github.com/orgs/rhodyprog4ds</td>
      <td>https://avatars.githubusercontent.com/u/69595187?</td>
    </tr>
    <tr>
      <th>3</th>
      <td>41898282</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
      <td>592944632</td>
      <td>rhodyprog4ds/BrownSpring23</td>
      <td>https://api.github.com/repos/rhodyprog4ds/Brow...</td>
      <td>592944632.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>69595187</td>
      <td>rhodyprog4ds</td>
      <td></td>
      <td>https://api.github.com/orgs/rhodyprog4ds</td>
      <td>https://avatars.githubusercontent.com/u/69595187?</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
      <td>592944632</td>
      <td>rhodyprog4ds/BrownSpring23</td>
      <td>https://api.github.com/repos/rhodyprog4ds/Brow...</td>
      <td>592944632.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>69595187</td>
      <td>rhodyprog4ds</td>
      <td></td>
      <td>https://api.github.com/orgs/rhodyprog4ds</td>
      <td>https://avatars.githubusercontent.com/u/69595187?</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 29 columns</p>
</div></div></div>
</div>
<p>This is close, but a lot of columns have the same name. To fix this we will
rename the new columns so that they have the original column
name prepended to the new name.</p>
<p>pandas has a rename method for this.</p>
<p>and this is another job for lambdas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">gh_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">c</span><span class="p">,</span><span class="n">col</span><span class="p">]))</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">js_cols</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span> <span class="p">[</span><span class="mi">35</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="nn">----&gt; 1 pd.concat([gh_df[col].apply(pd.Series).rename(lambda c: &#39;_&#39;.join([c,col])) for col</span> in <span class="ni">js_cols],axis=1).head</span><span class="nt">()</span>

<span class="nn">Cell In [35], line 1,</span> in <span class="ni">&lt;listcomp&gt;</span><span class="nt">(.0)</span>
<span class="nn">----&gt; 1 pd.concat([gh_df[col].apply(pd.Series).rename(lambda c: &#39;_&#39;.join([c,col])) for col</span> in <span class="ni">js_cols],axis=1).head</span><span class="nt">()</span>

<span class="nn">File /Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pandas/core/frame.py:5573,</span> in <span class="ni">DataFrame.rename</span><span class="nt">(self, mapper, index, columns, axis, copy, inplace, level, errors)</span>
<span class="g g-Whitespace">   </span><span class="mi">5454</span> <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">5455</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">5456</span>     <span class="n">mapper</span><span class="p">:</span> <span class="n">Renamer</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">5464</span>     <span class="n">errors</span><span class="p">:</span> <span class="n">IgnoreRaise</span> <span class="o">=</span> <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">5465</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">5466</span>     <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">5467</span><span class="sd">     Alter axes labels.</span>
<span class="g g-Whitespace">   </span><span class="mi">5468</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">5571</span><span class="sd">     4  3  6</span>
<span class="g g-Whitespace">   </span><span class="mi">5572</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">5573</span>     <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_rename</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">5574</span>         <span class="n">mapper</span><span class="o">=</span><span class="n">mapper</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">5575</span>         <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">5576</span>         <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">5577</span>         <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">5578</span>         <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">5579</span>         <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">5580</span>         <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">5581</span>         <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">5582</span>     <span class="p">)</span>

<span class="nn">File /Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pandas/core/generic.py:1104,</span> in <span class="ni">NDFrame._rename</span><span class="nt">(self, mapper, index, columns, axis, copy, inplace, level, errors)</span>
<span class="g g-Whitespace">   </span><span class="mi">1097</span>         <span class="n">missing_labels</span> <span class="o">=</span> <span class="p">[</span>
<span class="g g-Whitespace">   </span><span class="mi">1098</span>             <span class="n">label</span>
<span class="nn">   1099             for index, label</span> in <span class="ni">enumerate</span><span class="nt">(replacements)</span>
<span class="g g-Whitespace">   </span><span class="mi">1100</span>             <span class="k">if</span> <span class="n">indexer</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
<span class="g g-Whitespace">   </span><span class="mi">1101</span>         <span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1102</span>         <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">missing_labels</span><span class="si">}</span><span class="s2"> not found in axis&quot;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1104</span> <span class="n">new_index</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">_transform_index</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1105</span> <span class="n">result</span><span class="o">.</span><span class="n">_set_axis_nocheck</span><span class="p">(</span><span class="n">new_index</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis_no</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1106</span> <span class="n">result</span><span class="o">.</span><span class="n">_clear_item_cache</span><span class="p">()</span>

<span class="nn">File /Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pandas/core/indexes/base.py:6416,</span> in <span class="ni">Index._transform_index</span><span class="nt">(self, func, level)</span>
<span class="g g-Whitespace">   </span><span class="mi">6414</span>     <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">6415</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">6416</span>     <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">6417</span>     <span class="k">return</span> <span class="n">Index</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">tupleize_cols</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nn">File /Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pandas/core/indexes/base.py:6416,</span> in <span class="ni">&lt;listcomp&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">   </span><span class="mi">6414</span>     <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">6415</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">6416</span>     <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">6417</span>     <span class="k">return</span> <span class="n">Index</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">tupleize_cols</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nn">Cell In [35], line 1,</span> in <span class="ni">&lt;lambda&gt;</span><span class="nt">(c)</span>
<span class="nn">----&gt; 1 pd.concat([gh_df[col].apply(pd.Series).rename(lambda c: &#39;_&#39;.join([c,col])) for col</span> in <span class="ni">js_cols],axis=1).head</span><span class="nt">()</span>

<span class="ne">TypeError</span>: sequence item 0: expected str instance, int found
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gh_df</span><span class="p">[</span><span class="s1">&#39;actor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">c</span><span class="p">,</span><span class="s1">&#39;actor&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_actor</th>
      <th>login_actor</th>
      <th>display_login_actor</th>
      <th>gravatar_id_actor</th>
      <th>url_actor</th>
      <th>avatar_url_actor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>41898282</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
    </tr>
    <tr>
      <th>1</th>
      <td>41898282</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
    <tr>
      <th>3</th>
      <td>41898282</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
    <tr>
      <th>5</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
    <tr>
      <th>7</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
    <tr>
      <th>8</th>
      <td>41898282</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
    <tr>
      <th>10</th>
      <td>41898282</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
    </tr>
    <tr>
      <th>11</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
    <tr>
      <th>12</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
    <tr>
      <th>13</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
    <tr>
      <th>14</th>
      <td>41898282</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
    </tr>
    <tr>
      <th>15</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
    <tr>
      <th>16</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
    <tr>
      <th>17</th>
      <td>41898282</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
    </tr>
    <tr>
      <th>18</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
    <tr>
      <th>19</th>
      <td>41898282</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
    </tr>
    <tr>
      <th>20</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
    <tr>
      <th>21</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
    <tr>
      <th>22</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
    <tr>
      <th>23</th>
      <td>41898282</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
    </tr>
    <tr>
      <th>24</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
    <tr>
      <th>25</th>
      <td>41898282</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
    </tr>
    <tr>
      <th>26</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
    <tr>
      <th>27</th>
      <td>41898282</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
    </tr>
    <tr>
      <th>28</th>
      <td>41898282</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
    </tr>
    <tr>
      <th>29</th>
      <td>10656079</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">json_cols_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">gh_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">c</span><span class="p">,</span><span class="n">col</span><span class="p">]))</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">js_cols</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gh_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;id&#39;, &#39;type&#39;, &#39;actor&#39;, &#39;repo&#39;, &#39;payload&#39;, &#39;public&#39;, &#39;created_at&#39;,
       &#39;org&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">json_cols_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;id_actor&#39;, &#39;login_actor&#39;, &#39;display_login_actor&#39;, &#39;gravatar_id_actor&#39;,
       &#39;url_actor&#39;, &#39;avatar_url_actor&#39;, &#39;id_repo&#39;, &#39;name_repo&#39;, &#39;url_repo&#39;,
       &#39;repository_id_payload&#39;, &#39;push_id_payload&#39;, &#39;size_payload&#39;,
       &#39;distinct_size_payload&#39;, &#39;ref_payload&#39;, &#39;head_payload&#39;,
       &#39;before_payload&#39;, &#39;commits_payload&#39;, &#39;action_payload&#39;,
       &#39;release_payload&#39;, &#39;ref_type_payload&#39;, &#39;master_branch_payload&#39;,
       &#39;description_payload&#39;, &#39;pusher_type_payload&#39;, &#39;issue_payload&#39;, &#39;id_org&#39;,
       &#39;login_org&#39;, &#39;gravatar_id_org&#39;, &#39;url_org&#39;, &#39;avatar_url_org&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Then we can put the two parts of the data together</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">gh_df</span><span class="p">[[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="s1">&#39;public&#39;</span><span class="p">,</span><span class="s1">&#39;created_at&#39;</span><span class="p">]],</span><span class="n">json_cols_df</span><span class="p">],)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>type</th>
      <th>public</th>
      <th>created_at</th>
      <th>id_actor</th>
      <th>login_actor</th>
      <th>display_login_actor</th>
      <th>gravatar_id_actor</th>
      <th>url_actor</th>
      <th>avatar_url_actor</th>
      <th>...</th>
      <th>ref_type_payload</th>
      <th>master_branch_payload</th>
      <th>description_payload</th>
      <th>pusher_type_payload</th>
      <th>issue_payload</th>
      <th>id_org</th>
      <th>login_org</th>
      <th>gravatar_id_org</th>
      <th>url_org</th>
      <th>avatar_url_org</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.756634e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-08 04:20:33+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.756632e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-08 04:18:47+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.756630e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-08 04:17:02+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.756629e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-08 04:16:08+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.756628e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-08 04:15:05+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.756627e+10</td>
      <td>ReleaseEvent</td>
      <td>True</td>
      <td>2023-03-08 04:13:53+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2.756626e+10</td>
      <td>CreateEvent</td>
      <td>True</td>
      <td>2023-03-08 04:13:22+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2.756625e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-08 04:12:47+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2.756610e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-08 04:00:29+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2.756605e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-08 03:57:05+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2.756481e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-08 02:20:30+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2.756477e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-08 02:17:12+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2.756270e+10</td>
      <td>IssuesEvent</td>
      <td>True</td>
      <td>2023-03-07 23:46:48+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2.753462e+10</td>
      <td>ReleaseEvent</td>
      <td>True</td>
      <td>2023-03-07 01:56:11+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2.753461e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-07 01:55:20+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2.753458e+10</td>
      <td>CreateEvent</td>
      <td>True</td>
      <td>2023-03-07 01:52:36+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2.753457e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-07 01:52:16+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2.742338e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-01 18:18:49+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2.742331e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-01 18:15:43+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2.741335e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-01 12:07:33+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2.741329e+10</td>
      <td>CreateEvent</td>
      <td>True</td>
      <td>2023-03-01 12:05:02+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2.741329e+10</td>
      <td>ReleaseEvent</td>
      <td>True</td>
      <td>2023-03-01 12:05:01+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2.741326e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-01 12:03:45+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2.741324e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-01 12:02:58+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2.741314e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-01 11:59:39+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2.741294e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-01 11:51:18+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2.741287e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-01 11:48:08+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2.740257e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-01 02:35:34+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2.740257e+10</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-01 02:34:56+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2.740256e+10</td>
      <td>ReleaseEvent</td>
      <td>True</td>
      <td>2023-03-01 02:34:19+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>41898282.0</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>69595187.0</td>
      <td>rhodyprog4ds</td>
      <td></td>
      <td>https://api.github.com/orgs/rhodyprog4ds</td>
      <td>https://avatars.githubusercontent.com/u/69595187?</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>41898282.0</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>69595187.0</td>
      <td>rhodyprog4ds</td>
      <td></td>
      <td>https://api.github.com/orgs/rhodyprog4ds</td>
      <td>https://avatars.githubusercontent.com/u/69595187?</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>10656079.0</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>69595187.0</td>
      <td>rhodyprog4ds</td>
      <td></td>
      <td>https://api.github.com/orgs/rhodyprog4ds</td>
      <td>https://avatars.githubusercontent.com/u/69595187?</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>41898282.0</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>69595187.0</td>
      <td>rhodyprog4ds</td>
      <td></td>
      <td>https://api.github.com/orgs/rhodyprog4ds</td>
      <td>https://avatars.githubusercontent.com/u/69595187?</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>10656079.0</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>69595187.0</td>
      <td>rhodyprog4ds</td>
      <td></td>
      <td>https://api.github.com/orgs/rhodyprog4ds</td>
      <td>https://avatars.githubusercontent.com/u/69595187?</td>
    </tr>
  </tbody>
</table>
<p>35 rows × 33 columns</p>
</div></div></div>
</div>
<p>and finally save this</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gh_df_clean</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">gh_df</span><span class="p">[[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="s1">&#39;public&#39;</span><span class="p">,</span><span class="s1">&#39;created_at&#39;</span><span class="p">]],</span><span class="n">json_cols_df</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">gh_df_clean</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>type</th>
      <th>public</th>
      <th>created_at</th>
      <th>id_actor</th>
      <th>login_actor</th>
      <th>display_login_actor</th>
      <th>gravatar_id_actor</th>
      <th>url_actor</th>
      <th>avatar_url_actor</th>
      <th>...</th>
      <th>ref_type_payload</th>
      <th>master_branch_payload</th>
      <th>description_payload</th>
      <th>pusher_type_payload</th>
      <th>issue_payload</th>
      <th>id_org</th>
      <th>login_org</th>
      <th>gravatar_id_org</th>
      <th>url_org</th>
      <th>avatar_url_org</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>27566343224</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-08 04:20:33+00:00</td>
      <td>41898282.0</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>69595187.0</td>
      <td>rhodyprog4ds</td>
      <td></td>
      <td>https://api.github.com/orgs/rhodyprog4ds</td>
      <td>https://avatars.githubusercontent.com/u/69595187?</td>
    </tr>
    <tr>
      <th>1</th>
      <td>27566322788</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-08 04:18:47+00:00</td>
      <td>41898282.0</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>69595187.0</td>
      <td>rhodyprog4ds</td>
      <td></td>
      <td>https://api.github.com/orgs/rhodyprog4ds</td>
      <td>https://avatars.githubusercontent.com/u/69595187?</td>
    </tr>
    <tr>
      <th>2</th>
      <td>27566302748</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-08 04:17:02+00:00</td>
      <td>10656079.0</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>69595187.0</td>
      <td>rhodyprog4ds</td>
      <td></td>
      <td>https://api.github.com/orgs/rhodyprog4ds</td>
      <td>https://avatars.githubusercontent.com/u/69595187?</td>
    </tr>
    <tr>
      <th>3</th>
      <td>27566292375</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-08 04:16:08+00:00</td>
      <td>41898282.0</td>
      <td>github-actions[bot]</td>
      <td>github-actions</td>
      <td></td>
      <td>https://api.github.com/users/github-actions[bot]</td>
      <td>https://avatars.githubusercontent.com/u/41898282?</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>69595187.0</td>
      <td>rhodyprog4ds</td>
      <td></td>
      <td>https://api.github.com/orgs/rhodyprog4ds</td>
      <td>https://avatars.githubusercontent.com/u/69595187?</td>
    </tr>
    <tr>
      <th>4</th>
      <td>27566280466</td>
      <td>PushEvent</td>
      <td>True</td>
      <td>2023-03-08 04:15:05+00:00</td>
      <td>10656079.0</td>
      <td>brownsarahm</td>
      <td>brownsarahm</td>
      <td></td>
      <td>https://api.github.com/users/brownsarahm</td>
      <td>https://avatars.githubusercontent.com/u/10656079?</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>69595187.0</td>
      <td>rhodyprog4ds</td>
      <td></td>
      <td>https://api.github.com/orgs/rhodyprog4ds</td>
      <td>https://avatars.githubusercontent.com/u/69595187?</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 33 columns</p>
</div></div></div>
</div>
<p>If we want to analyze this data, this is a good place to save it to disk and start an analysis in  separate notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gh_df_clean</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;gh_events_unpacked.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="questions-after-class">
<h2><span class="section-number">8.7. </span>Questions After Class<a class="headerlink" href="#questions-after-class" title="Permalink to this headline">#</a></h2>
<div class="section" id="how-the-apply-function-works-use-cases">
<h3><span class="section-number">8.7.1. </span>How the apply function works/use cases?<a class="headerlink" href="#how-the-apply-function-works-use-cases" title="Permalink to this headline">#</a></h3>
<p>A4 will give you some examples, espeically the airline dataset. We will also keep seing it come up as we manipulate data more.</p>
<p>the <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.apply.html">apply docs</a> have tiny examples that help illustrate what it does and some of how it works. The <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/gotchas.html#mutating-with-user-defined-function-udf-methods">pandas faq has a section on apply and similar methods</a> that gives some more use cases.</p>
</div>
<div class="section" id="is-there-a-better-way-to-see-how-many-missing-values">
<h3><span class="section-number">8.7.2. </span>Is there a better way to see how many missing values?<a class="headerlink" href="#is-there-a-better-way-to-see-how-many-missing-values" title="Permalink to this headline">#</a></h3>
<p>There are lots of ways. All are fine. We used <code class="docutils literal notranslate"><span class="pre">info</span></code> in class because I was trying to use the way we had already seen.
Info focuses on how many values are <em>present</em> instead of what is missing because it makes more sense in most cases. The more common question is: are there enough values to make decisions with?</p>
<p>If you wanted to get counts of the missing values, you can use the pandas <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.isna.html"><code class="docutils literal notranslate"><span class="pre">isna</span></code></a> function.  It is a pandas function, the docs say <code class="docutils literal notranslate"><span class="pre">pandas.isna</span></code> not a DataFrame method (which would be described like <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.methodname</span></code>).
This means we use it like</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">value_to_test</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">value_to_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="admonition-try-it-yourself admonition">
<p class="admonition-title">Try it Yourself</p>
<p>pass different values like: <code class="docutils literal notranslate"><span class="pre">False</span></code>, <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> (also <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span></code>) and, <code class="docutils literal notranslate"><span class="pre">pd.NA</span></code>, <code class="docutils literal notranslate"><span class="pre">hello</span></code> to this function</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function isna in module pandas.core.dtypes.missing:

isna(obj: &#39;object&#39;) -&gt; &#39;bool | npt.NDArray[np.bool_] | NDFrame&#39;
    Detect missing values for an array-like object.
    
    This function takes a scalar or array-like object and indicates
    whether values are missing (``NaN`` in numeric arrays, ``None`` or ``NaN``
    in object arrays, ``NaT`` in datetimelike).
    
    Parameters
    ----------
    obj : scalar or array-like
        Object to check for null or missing values.
    
    Returns
    -------
    bool or array-like of bool
        For scalar input, returns a scalar boolean.
        For array input, returns an array of boolean indicating whether each
        corresponding element is missing.
    
    See Also
    --------
    notna : Boolean inverse of pandas.isna.
    Series.isna : Detect missing values in a Series.
    DataFrame.isna : Detect missing values in a DataFrame.
    Index.isna : Detect missing values in an Index.
    
    Examples
    --------
    Scalar arguments (including strings) result in a scalar boolean.
    
    &gt;&gt;&gt; pd.isna(&#39;dog&#39;)
    False
    
    &gt;&gt;&gt; pd.isna(pd.NA)
    True
    
    &gt;&gt;&gt; pd.isna(np.nan)
    True
    
    ndarrays result in an ndarray of booleans.
    
    &gt;&gt;&gt; array = np.array([[1, np.nan, 3], [4, 5, np.nan]])
    &gt;&gt;&gt; array
    array([[ 1., nan,  3.],
           [ 4.,  5., nan]])
    &gt;&gt;&gt; pd.isna(array)
    array([[False,  True, False],
           [False, False,  True]])
    
    For indexes, an ndarray of booleans is returned.
    
    &gt;&gt;&gt; index = pd.DatetimeIndex([&quot;2017-07-05&quot;, &quot;2017-07-06&quot;, None,
    ...                           &quot;2017-07-08&quot;])
    &gt;&gt;&gt; index
    DatetimeIndex([&#39;2017-07-05&#39;, &#39;2017-07-06&#39;, &#39;NaT&#39;, &#39;2017-07-08&#39;],
                  dtype=&#39;datetime64[ns]&#39;, freq=None)
    &gt;&gt;&gt; pd.isna(index)
    array([False, False,  True, False])
    
    For Series and DataFrame, the same type is returned, containing booleans.
    
    &gt;&gt;&gt; df = pd.DataFrame([[&#39;ant&#39;, &#39;bee&#39;, &#39;cat&#39;], [&#39;dog&#39;, None, &#39;fly&#39;]])
    &gt;&gt;&gt; df
         0     1    2
    0  ant   bee  cat
    1  dog  None  fly
    &gt;&gt;&gt; pd.isna(df)
           0      1      2
    0  False  False  False
    1  False   True  False
    
    &gt;&gt;&gt; pd.isna(df[1])
    0    False
    1     True
    Name: 1, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>The docstring says that it returns “bool or array-like of bool” but if we go to the website docs that have more examples, we can find out what that it will <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.isna.html#:~:text=For%20Series%20and%20DataFrame%2C%20the%20same%20type%20is%20returned%2C%20containing%20booleans">return a DataFrame if we pass it a DataFrame</a>. Then we can use the <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sum.html"><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.sum</span></code></a> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">coffee_df_clean</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>species                        0
owner                          7
country_of_origin              1
farm_name                    356
lot_number                  1041
mill                         310
ico_number                   146
company                      209
altitude                     223
region                        57
producer                     230
number_of_bags                 0
bag_weight                     0
in_country_partner             0
harvest_year                  47
grading_date                   0
owner_1                        7
variety                      201
processing_method            152
aroma                          0
flavor                         0
aftertaste                     0
acidity                        0
body                           0
balance                        0
uniformity                     0
clean_cup                      0
sweetness                      0
cupper_points                  0
total_cup_points               0
moisture                       0
category_one_defects           0
quakers                        1
color                        216
category_two_defects           0
expiration                     0
certification_body             0
certification_address          0
certification_contact          0
unit_of_measurement            0
altitude_low_meters          227
altitude_high_meters         227
altitude_mean_meters         227
unit_of_measurement_long       0
lot_number_clean               0
dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="in-col-name-mapper-col-name-col-name-lower-replace-for-col-name-in-coffee-df-columns-what-is-the-for">
<h3><span class="section-number">8.7.3. </span>in <code class="docutils literal notranslate"><span class="pre">col_name_mapper</span> <span class="pre">=</span> <span class="pre">{col_name:col_name.lower().replace('.','_')</span> <span class="pre">for</span> <span class="pre">col_name</span> <span class="pre">in</span> <span class="pre">coffee_df.columns}</span></code> what is the <code class="docutils literal notranslate"><span class="pre">{}</span></code> for?<a class="headerlink" href="#in-col-name-mapper-col-name-col-name-lower-replace-for-col-name-in-coffee-df-columns-what-is-the-for" title="Permalink to this headline">#</a></h3>
<p>This is called a dictionary comphrehension. It is very similar to a <a class="reference external" href="https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions">list comprehension</a>. It is one of the <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict">defined ways to build a <code class="docutils literal notranslate"><span class="pre">dict</span></code> type object</a></p>
<p>We also saw one when we looked at different types in a <a class="reference internal" href="2023-02-02.html"><span class="doc std std-doc">previous class</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">char</span><span class="p">:</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="s1">&#39;abcde&#39;</span><span class="p">)}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;a&#39;: 0, &#39;b&#39;: 1, &#39;c&#39;: 2, &#39;d&#39;: 3, &#39;e&#39;: 4}
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#enumerate"><code class="docutils literal notranslate"><span class="pre">enumerate</span></code></a> is a built in function that
iterates over items in an iterable type(list-like) and pops the each value paired with its index within
the structure.</p>
<p>This way we get each character and it’s position. We could use this as follows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_chars</span> <span class="o">=</span> <span class="p">{</span><span class="n">char</span><span class="p">:</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="s1">&#39;abcde&#39;</span><span class="p">)}</span>
<span class="n">alpha_data</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>  <span class="n">Cell</span> <span class="n">In</span> <span class="p">[</span><span class="mi">47</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
    <span class="n">alpha_data</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;]</span>
                                        <span class="o">^</span>
<span class="ne">SyntaxError</span>: EOL while scanning string literal
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notes"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="2023-02-14.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">7. </span>Tidy Data and Reshaping Datasets</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="2023-02-21.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">9. </span>Merging  and Databases</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Professor Sarah M Brown<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>